var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") return Reflect.decorate(decorators, target, key, desc);
    switch (arguments.length) {
        case 2: return decorators.reduceRight(function(o, d) { return (d && d(o)) || o; }, target);
        case 3: return decorators.reduceRight(function(o, d) { return (d && d(target, key)), void 0; }, void 0);
        case 4: return decorators.reduceRight(function(o, d) { return (d && d(target, key, o)) || o; }, desc);
    }
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
var __param = (this && this.__param) || function (paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
};
var angular2_1 = require('angular2/angular2');
var http_1 = require('http/http');
var cookie_1 = require('src/services/cookie');
var Client = (function () {
    function Client(http) {
        this.http = http;
        this.base = "/";
        this.cookie = new cookie_1.Cookie();
    }
    Client.prototype.buildParams = function (object) {
        return Object.keys(object).map(function (k) {
            return encodeURIComponent(k) + "=" + encodeURIComponent(object[k]);
        }).join('&');
    };
    Client.prototype.buildOptions = function (options) {
        var XSRF_TOKEN = this.cookie.get('XSRF-TOKEN');
        var headers = new http_1.Headers();
        headers.append('X-XSRF-TOKEN', XSRF_TOKEN);
        return Object.assign(options, {
            headers: headers,
            cache: true
        });
    };
    Client.prototype.get = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        endpoint += "?" + this.buildParams(data);
        return new Promise(function (resolve, reject) {
            self.http.get(self.base + endpoint, _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                if (data.status != 'success')
                    return reject(data);
                return resolve(data);
            });
        });
    };
    Client.prototype.post = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        return new Promise(function (resolve, reject) {
            self.http.post(self.base + endpoint, JSON.stringify(data), _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                if (data.status != 'success')
                    return reject(data);
                return resolve(data);
            });
        });
    };
    Client.prototype.put = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        return new Promise(function (resolve, reject) {
            self.http.put(self.base + endpoint, JSON.stringify(data), _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                if (data.status != 'success')
                    return reject(data);
                return resolve(data);
            });
        });
    };
    Client.prototype.delete = function (endpoint, data, options) {
        var _this = this;
        if (data === void 0) { data = {}; }
        if (options === void 0) { options = {}; }
        var self = this;
        return new Promise(function (resolve, reject) {
            self.http.delete(self.base + endpoint, _this.buildOptions(options))
                .toRx()
                .subscribe(function (res) {
                if (res.status != 200) {
                    return reject("Header: " + status);
                }
                var data = res.json();
                if (data.status != 'success')
                    return reject(data);
                return resolve(data);
            });
        });
    };
    Client = __decorate([
        __param(0, angular2_1.Inject(http_1.Http)), 
        __metadata('design:paramtypes', [http_1.Http])
    ], Client);
    return Client;
})();
exports.Client = Client;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9zZXJ2aWNlcy9hcGkvY2xpZW50LnRzIl0sIm5hbWVzIjpbIkNsaWVudCIsIkNsaWVudC5jb25zdHJ1Y3RvciIsIkNsaWVudC5idWlsZFBhcmFtcyIsIkNsaWVudC5idWlsZE9wdGlvbnMiLCJDbGllbnQuZ2V0IiwiQ2xpZW50LnBvc3QiLCJDbGllbnQucHV0IiwiQ2xpZW50LmRlbGV0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQSx5QkFBcUMsbUJBQW1CLENBQUMsQ0FBQTtBQUN6RCxxQkFBNEIsV0FBVyxDQUFDLENBQUE7QUFDeEMsdUJBQXFCLHFCQUFxQixDQUFDLENBQUE7QUFLM0M7SUFHQ0EsZ0JBQWlDQSxJQUFXQTtRQUFYQyxTQUFJQSxHQUFKQSxJQUFJQSxDQUFPQTtRQUY1Q0EsU0FBSUEsR0FBWUEsR0FBR0EsQ0FBQ0E7UUFDcEJBLFdBQU1BLEdBQVlBLElBQUlBLGVBQU1BLEVBQUVBLENBQUNBO0lBQ2dCQSxDQUFDQTtJQUV4Q0QsNEJBQVdBLEdBQW5CQSxVQUFvQkEsTUFBZUE7UUFDbENFLE1BQU1BLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLFVBQUNBLENBQUNBO1lBQ2hDQSxNQUFNQSxDQUFDQSxrQkFBa0JBLENBQUNBLENBQUNBLENBQUNBLEdBQUdBLEdBQUdBLEdBQUdBLGtCQUFrQkEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDcEVBLENBQUNBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO0lBQ2RBLENBQUNBO0lBS09GLDZCQUFZQSxHQUFwQkEsVUFBcUJBLE9BQWdCQTtRQUNwQ0csSUFBSUEsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7UUFDL0NBLElBQUlBLE9BQU9BLEdBQUdBLElBQUlBLGNBQU9BLEVB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QSxJQUFJQSxDQUFDQSxDQUFDQTtZQUN2QkEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7UUFDTEEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7SUFDSkEsQ0FBQ0E7SUF6SEZQO1FBR2FBLFdBQUNBLGlCQUFNQSxDQUFDQSxXQUFJQSxDQUFDQSxDQUFBQTs7ZUF1SHpCQTtJQUFEQSxhQUFDQTtBQUFEQSxDQTFIQSxBQTBIQ0EsSUFBQTtBQTFIWSxjQUFNLFNBMEhsQixDQUFBIiwiZmlsZSI6InNyYy9zZXJ2aWNlcy9hcGkvY2xpZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtJbmplY3QsIEluamVjdG9yLCBiaW5kfSBmcm9tICdhbmd1bGFyMi9hbmd1bGFyMic7XG5pbXBvcnQge0h0dHAsIEhlYWRlcnN9IGZyb20gJ2h0dHAvaHR0cCc7XG5pbXBvcnQge0Nvb2tpZX0gZnJvbSAnc3JjL3NlcnZpY2VzL2Nvb2tpZSc7XG5cbi8qKlxuICogQVBJIENsYXNzXG4gKi9cbmV4cG9ydCBjbGFzcyBDbGllbnQge1xuXHRiYXNlIDogc3RyaW5nID0gXCIvXCI7XG5cdGNvb2tpZSA6IENvb2tpZSA9IG5ldyBDb29raWUoKTtcblx0Y29uc3RydWN0b3IoQEluamVjdChIdHRwKSBwdWJsaWMgaHR0cCA6IEh0dHApeyB9XG5cblx0cHJpdmF0ZSBidWlsZFBhcmFtcyhvYmplY3QgOiBPYmplY3Qpe1xuXHRcdHJldHVybiBPYmplY3Qua2V5cyhvYmplY3QpLm1hcCgoaykgPT4ge1xuXHRcdFx0cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChrKSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KG9iamVjdFtrXSk7XG5cdFx0fSkuam9pbignJicpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEJ1aWxkIHRoZSBvcHRpb25zXG5cdCAqL1xuXHRwcml2YXRlIGJ1aWxkT3B0aW9ucyhvcHRpb25zIDogT2JqZWN0KXtcblx0XHR2YXIgWFNSRl9UT0tFTiA9IHRoaXMuY29va2llLmdldCgnWFNSRi1UT0tFTicpO1xuXHRcdHZhciBoZWFkZXJzID0gbmV3IEhlYWRlcnMoKTtcblx0XHRoZWFkZXJzLmFwcGVuZCgnWC1YU1JGLVRPS0VOJywgWFNSRl9UT0tFTik7XG5cdFx0cmV0dXJuIE9iamVjdC5hc3NpZ24ob3B0aW9ucywge1xuXHRcdFx0XHRcdGhlYWRlcnM6IGhlYWRlcnMsXG5cdFx0XHRcdFx0Y2FjaGU6IHRydWVcblx0XHRcdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogUmV0dXJuIGEgR0VUIHJlcXVlc3Rcblx0ICovXG5cdGdldChlbmRwb2ludCA6IHN0cmluZywgZGF0YSA6IE9iamVjdCA9IHt9LCBvcHRpb25zOiBPYmplY3QgPSB7fSl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdGVuZHBvaW50ICs9IFwiP1wiICsgdGhpcy5idWlsZFBhcmFtcyhkYXRhKTtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0c2VsZi5odHRwLmdldChcblx0XHRcdFx0XHRzZWxmLmJhc2UgKyBlbmRwb2ludCxcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhvcHRpb25zKVxuXHRcdFx0XHQpXG5cdFx0XHRcdC50b1J4KClcblx0XHRcdFx0LnN1YnNjcmliZShyZXMgPT4ge1xuXHRcdFx0XHRcdFx0aWYocmVzLnN0YXR1cyAhPSAyMDApe1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVqZWN0KFwiSGVhZGVyOiBcIiArIHN0YXR1cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgZGF0YSA9IHJlcy5qc29uKCk7XG5cdFx0XHRcdFx0XHRpZihkYXRhLnN0YXR1cyAhPSAnc3VjY2VzcycpXG5cdFx0XHRcdFx0XHRcdHJldHVybiByZWplY3QoZGF0YSk7XG5cblx0XHRcdFx0XHRcdHJldHVybiByZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZXR1cm4gYSBQT1NUIHJlcXVlc3Rcblx0ICovXG5cdHBvc3QoZW5kcG9pbnQgOiBzdHJpbmcsIGRhdGEgOiBPYmplY3QgPSB7fSwgb3B0aW9uczogT2JqZWN0ID0ge30pe1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0c2VsZi5odHRwLnBvc3QoXG5cdFx0XHRcdFx0c2VsZi5iYXNlICsgZW5kcG9pbnQsXG5cdFx0XHRcdFx0SlNPTi5zdHJpbmdpZnkoZGF0YSksXG5cdFx0XHRcdFx0dGhpcy5idWlsZE9wdGlvbnMob3B0aW9ucylcblx0XHRcdFx0KVxuXHRcdFx0XHQudG9SeCgpXG5cdFx0XHRcdC5zdWJzY3JpYmUocmVzID0+IHtcblx0XHRcdFx0XHRcdGlmKHJlcy5zdGF0dXMgIT0gMjAwKXtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlamVjdChcIkhlYWRlcjogXCIgKyBzdGF0dXMpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0dmFyIGRhdGEgPSByZXMuanNvbigpO1xuXHRcdFx0XHRcdFx0aWYoZGF0YS5zdGF0dXMgIT0gJ3N1Y2Nlc3MnKVxuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVqZWN0KGRhdGEpO1xuXG5cdFx0XHRcdFx0XHRyZXR1cm4gcmVzb2x2ZShkYXRhKTtcblx0XHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxuXHQvKipcblx0ICogUmV0dXJuIGEgUFVUIHJlcXVlc3Rcblx0ICovXG5cdHB1dChlbmRwb2ludCA6IHN0cmluZywgZGF0YSA6IE9iamVjdCA9IHt9LCBvcHRpb25zOiBPYmplY3QgPSB7fSl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cdFx0XHRzZWxmLmh0dHAucHV0KFxuXHRcdFx0XHRcdHNlbGYuYmFzZSArIGVuZHBvaW50LFxuXHRcdFx0XHRcdEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuXHRcdFx0XHRcdHRoaXMuYnVpbGRPcHRpb25zKG9wdGlvbnMpXG5cdFx0XHRcdClcblx0XHRcdFx0LnRvUngoKVxuXHRcdFx0XHQuc3Vic2NyaWJlKHJlcyA9PiB7XG5cdFx0XHRcdFx0XHRpZihyZXMuc3RhdHVzICE9IDIwMCl7XG5cdFx0XHRcdFx0XHRcdHJldHVybiByZWplY3QoXCJIZWFkZXI6IFwiICsgc3RhdHVzKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZhciBkYXRhID0gcmVzLmpzb24oKTtcblx0XHRcdFx0XHRcdGlmKGRhdGEuc3RhdHVzICE9ICdzdWNjZXNzJylcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJlamVjdChkYXRhKTtcblxuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc29sdmUoZGF0YSk7XG5cdFx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cblx0LyoqXG5cdCAqIFJldHVybiBhIERFTEVURSByZXF1ZXN0XG5cdCAqL1xuXHRkZWxldGUoZW5kcG9pbnQgOiBzdHJpbmcsIGRhdGEgOiBPYmplY3QgPSB7fSwgb3B0aW9uczogT2JqZWN0ID0ge30pe1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0c2VsZi5odHRwLmRlbGV0ZShcblx0XHRcdFx0XHRzZWxmLmJhc2UgKyBlbmRwb2ludCxcblx0XHRcdFx0XHR0aGlzLmJ1aWxkT3B0aW9ucyhvcHRpb25zKVxuXHRcdFx0XHQpXG5cdFx0XHRcdC50b1J4KClcblx0XHRcdFx0LnN1YnNjcmliZShyZXMgPT4ge1xuXHRcdFx0XHRcdFx0aWYocmVzLnN0YXR1cyAhPSAyMDApe1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gcmVqZWN0KFwiSGVhZGVyOiBcIiArIHN0YXR1cyk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2YXIgZGF0YSA9IHJlcy5qc29uKCk7XG5cdFx0XHRcdFx0XHRpZihkYXRhLnN0YXR1cyAhPSAnc3VjY2VzcycpXG5cdFx0XHRcdFx0XHRcdHJldHVybiByZWplY3QoZGF0YSk7XG5cblx0XHRcdFx0XHRcdHJldHVybiByZXNvbHZlKGRhdGEpO1xuXHRcdFx0XHR9KTtcblx0XHR9KTtcblx0fVxufVxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9