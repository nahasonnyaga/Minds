<?php 

$entity = $vars['entity'];
elgg_load_js('player');
elgg_load_css('player');
?>

<script type='text/javascript'>
 
	window.onload = function (){
		 
		var video = document.getElementById('my_video');
		var thecanvas = document.getElementById('thecanvas');
		var img = document.getElementById('thumbnail_img');
		 
		 
		video.addEventListener('durationchange', function(){
			 
			draw( video, thecanvas, img);
			 
		}, false);
		 
	};
		 
		 
	function draw( video, thecanvas, img ){
		console.log('drawing');	 
		// get the canvas context for drawing
		var context = thecanvas.getContext('2d');
			 
		// draw the video contents into the canvas x, y, width, height
			context.drawImage( video, 0, 0, thecanvas.width, thecanvas.height);
			 
			// get the image data from the canvas object
			var dataURL = thecanvas.toDataURL();
			 
			// set the source of the img tag
			img.setAttribute('src', dataURL);
			 
		}
</script>

<video id="my_video" controls>
	<source src="<?php echo $entity->getSourceURL('360.webm');?>" type="video/webm" />
</video>
<br />
The Canvas
<br />
<canvas id="thecanvas">
</canvas>
<br />
The Image
<br />
<img id="thumbnail_img" alt="Right click to save" />
